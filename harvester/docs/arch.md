# Homelab Edgekit Architecture

## Overview

![homelab architecture](./static/homelab-edgekit.drawio.svg)

## Networking

![homelab architecture](./static/harvester-network.drawio.svg)

### Firewall rules

```
# Generated by iptables-save v1.8.11 (nf_tables) on Mon Feb 23 00:28:25 2026
*filter
:INPUT ACCEPT [21044:2270260]
:FORWARD ACCEPT [13246:788140]
:OUTPUT ACCEPT [0:0]
-A INPUT -s 10.240.0.0/16 -d 10.240.0.0/16 -j RETURN
-A INPUT -s 10.240.0.0/16 -d 192.168.0.0/16 -j RETURN
-A INPUT -s 10.240.0.0/16 -j DROP
-A FORWARD -i enp3s0.10 -o enp3s0.20 -m state --state NEW -j DROP
-A FORWARD -i enp3s0.20 -o enp3s0.10 -m state --state NEW -j DROP
COMMIT
# Completed on Mon Feb 23 00:28:25 2026
# Generated by iptables-save v1.8.11 (nf_tables) on Mon Feb 23 00:28:25 2026
*nat
:PREROUTING ACCEPT [0:0]
:INPUT ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:POSTROUTING ACCEPT [185:12204]
-A POSTROUTING -s 10.240.0.0/16 -d 192.168.0.0/16 -j MASQUERADE
COMMIT
# Completed on Mon Feb 23 00:28:25 2026
```

## Inventory

- Harvester cluster
  - 3 Minisforum UM700
  - 8-core, 32GiB RAM, 2TiB M.2 NVME
  - 2 NICs (1000baseT/Full)
- Switch
  - Netgear GS108Tv3
  - Web-managed, 8-port, VLAN aware
- Gateway
  - Minisforum GK41
  - 4-core, 8GiB RAM, 256GiB SATA
  - 2 NICs (1000baseT/Full)

### Gateway

- SL Micro 6.2
- Static route on enp3s0 (interface to Harvester cluster LAN)
- `dnsmasq` serving DHCP and DNS to 10.240.0.0/16
- `net.ipv4.ip_forward = 1`

### Harvester Cluster Nodes

- Harvester Government 1.7.1
  - SL Micro 6.1
  - RKE2 1.34.3
  - Rancher 2.13.1
  - Longhorn 1.10.2
  - KubeVirt 1.6.3
